import { ApiProperty } from '@nestjs/swagger';
import { ILoginResponse } from '../interface/auth.if';
import { JwtService, JwtSignOptions } from '@nestjs/jwt';
import { RefreshTokenData } from './refresh-token-data';

export class LoginResponseData extends RefreshTokenData implements ILoginResponse {
  // private jwt = new JwtService();
  constructor(tokenObj:any = undefined, jwt:JwtService | undefined = undefined, deviceObj:any = undefined,){
    super(tokenObj, jwt);
    console.log('object:', {...deviceObj})
    if (deviceObj) {
      const optD:JwtSignOptions = {
        secret: process.env.DEVICE_KEY,
        expiresIn: '3y', // 3 years  //'90d' // 3 months
      }
      if (deviceObj) this.deviceRefreshToken = jwt.sign({...deviceObj}, optD);
      console.log("jwt check2");
    }
    // delete this.jwt;
  }
  @ApiProperty({
    description: 'Image tag from otplib & qrcode, 首登入產生',
    example: '<svg xmlns="http://www.w3.org/2000/svg" width="110" height="40" viewBox="0,0,110,40"><rect width="100%" height="100%" fill="#cc9966"/><path fill="#494e4f" d="M83.47 33.51L83.58 33.62L83.56 33.59Q80.48 33.71 79.02 33.23L79.08 33.30L79.09 33.31Q77.21 32.61 76.93 29.58L76.92 29.58L78.23 28.64L78.23 28.64Q78.90 28.18 79.58 27.74L79.55 27.71L79.55 27.72Q79.26 29.37 80.69 30.45L80.80 30.57L80.81 30.57Q81.86 31.38 83.76 31.21L83.78 31.23L83.90 31.35Q87.65 30.82 87.48 27.66L87.48 27.66L87.49 27.67Q87.48 25.78 85.13 24.70L85.03 24.60L85.10 24.66Q82.59 23.75 80.48 22.66L80.50 22.68L80.40 22.58Q78.16 21.43 77.28 17.25L77.35 17.32L77.36 17.33Q77.12 16.79 77.02 16.11L77.04 16.12L77.05 16.14Q77.04 15.52 77.11 15.01L76.97 14.87L77.16 15.06Q77.18 13.51 78.30 13.11L78.32 13.13L78.24 13.05Q80.42 12.30 83.99 12.47L84.09 12.58L83.97 12.45Q85.65 12.61 86.37 12.68L86.39 12.70L86.42 12.73Q87.76 12.91 88.71 13.32L88.71 13.32L88.67 13.28Q90.59 13.73 90.79 15.94L90.83 15.98L90.76 15.92Q89.83 16.55 87.86 17.74L87.77 17.65L87.78 17.66Q87.44 15.01 83.53 15.01L83.47 14.95L83.55 15.02Q81.90 15.07 81.02 15.69L80.91 15.58L80.96 15.63Q79.90 16.07 80.10 17.66L80.16 17.72L80.17 17.73Q80.28 19.58 82.93 20.94L83.06 21.06L83.08 21.08Q83.43 21.16 87.44 22.62L87.46 22.64L87.51 22.69Q89.91 24.07 90.28 27.98L90.26 27.96L90.24 27.94Q90.23 28.06 90.29 29.18L90.29 29.18L90.29 29.18Q90.37 31.66 88.97 32.65L89.06 32.73L88.99 32.67Q87.25 33.45 83.52 33.55ZM85.67 35.77L85.72 35.83L85.70 35.81Q86.98 35.86 88.75 35.86L88.59 35.71L88.78 35.89Q90.47 35.71 91.59 35.34L91.59 35.33L91.77 35.51Q92.72 34.63 92.66 33.04L92.61 32.99L92.74 33.12Q92.66 32.19 92.32 30.36L92.33 30.37L92.24 30.28Q91.48 26.15 89.61 24.48L89.72 24.59L89.57 24.44Q89.04 23.20 87.85 22.56L87.86 22.57L83.04 20.63L82.92 20.52Q82.74 20.47 82.33 20.27L82.32 20.25L82.24 19.93L82.17 19.56L82.20 19.59Q82.02 18.29 83.04 17.75L83.02 17.73L83.14 17.84Q83.76 17.28 85.29 17.11L85.39 17.21L85.22 17.03Q86.26 16.95 87.28 17.36L87.32 17.40L87.25 17.33Q87.45 17.56 87.62 18.31L87.47 18.17L87.56 18.26Q87.67 18.06 88.11 17.85L88.28 18.03L88.19 17.93Q88.86 18.77 88.96 19.79L88.94 19.77L88.96 19.79Q89.04 19.77 92.30 17.46L92.20 17.36L92.30 17.45Q92.02 15.06 90.73 14.45L90.64 14.37L90.66 14.39Q90.16 13.28 88.87 12.80L88.94 12.87L88.98 12.91Q86.93 12.19 84.08 12.19L84.12 12.23L84.03 12.14Q79.68 12.18 78.02 12.79L77.91 12.69L78.00 12.77Q76.79 13.16 76.69 14.66L76.68 14.65L76.72 14.69Q76.68 15.15 77.05 17.13L77.02 17.10L77.11 17.18Q77.60 20.43 79.54 22.43L79.59 22.48L79.66 22.56Q80.31 24.02 81.65 24.63L81.62 24.61L81.65 24.63Q83.04 25.29 86.54 26.69L86.53 26.67L86.49 26.66L87.03 26.94L87.09 27.03L87.16 27.09Q87.27 27.45 87.30 27.75L87.20 27.65L87.24 27.69Q87.24 30.72 83.74 30.85L83.89 31.00L83.84 30.95Q82.84 31.00 81.68 30.66L81.61 30.59L81.66 30.64Q81.26 29.80 81.26 29.16L81.45 29.34L81.36 29.26Q81.44 29.09 81.47 28.85L81.40 28.78L81.37 28.76Q80.97 28.93 80.26 29.37L80.21 29.33L80.35 29.47Q79.83 28.41 79.97 27.18L80.03 27.24L79.93 27.15Q78.10 28.24 76.67 29.50L76.75 29.57L76.67 29.50Q76.81 30.31 76.88 31.23L76.76 31.11L76.76 31.11Q77.16 32.77 78.31 33.45L78.31 33.44L78.32 33.46Q79.32 34.99 81.59 35.33L81.69 35.43L81.62 35.36Q82.97 35.52 85.58 35.69Z"/><path fill="#3c3e42" d="M22.78 25.21L22.82 25.24L22.86 25.28Q22.84 23.91 22.11 23.10L22.26 23.24L22.15 23.13Q21.49 22.39 20.20 22.42L20.13 22.35L20.21 22.44Q18.08 22.45 17.33 24.35L17.36 24.38L17.27 24.28Q17.11 25.08 17.08 25.69L17.14 25.75L17.13 25.74Q16.93 30.06 16.11 33.94L16.03 33.86L16.03 33.86Q14.48 34.28 12.81 35.16L12.96 35.31L12.88 35.23Q14.86 28.94 14.62 22.42L14.59 22.39L14.69 22.49Q14.41 15.89 12.14 9.81L12.10 9.77L12.14 9.81Q13.67 10.93 15.47 11.55L15.50 11.58L15.44 11.52Q16.87 16.82 17.04 22.05L17.01 22.02L16.97 21.98Q18.33 20.25 20.74 20.31L20.65 20.22L20.76 20.33Q25.16 20.28 25.26 25.07L25.33 25.14L25.22 25.03Q25.36 30.14 26.59 34.28L26.74 34.43L26.73 34.43Q25.01 33.62 23.44 33.45L23.47 33.48L23.36 33.37Q22.92 30.48 22.82 25.25ZM23.15 33.73L23.13 33.72L23.13 33.72Q24.04 33.81 25.03 34.05L25.15 34.17L25.07 34.09Q25.06 34.19 25.54 35.95L25.49 35.90L25.55 35.97Q28.25 36.86 30.05 38.16L29.92 38.03L30.02 38.12Q27.62 32.98 27.15 27.33L27.06 27.24L27.20 27.38Q26.85 24.01 25.59 22.62L25.58 22.60L25.58 22.60Q25.60 22.56 25.02 22.15L25.08 22.20L25.05 22.18Q24.75 21.63 24.17 20.95L24.10 20.89L24.16 20.88L24.14 20.85Q23.54 20.26 20.75 20.02L20.61 19.88L20.68 19.94Q19.99 19.90 18.73 20.21L18.77 20.25L18.76 20.24Q18.47 15.80 18.17 13.56L18.17 13.56L18.24 13.63Q17.66 13.63 16.34 13.36L16.24 13.27L16.24 13.27Q16.19 12.70 15.95 11.38L15.84 11.27L15.90 11.33Q13.21 10.40 11.54 9.01L11.53 9.00L11.58 9.05Q14.07 15.28 14.31 22.25L14.49 22.43L14.43 22.36Q14.67 29.30 12.39 35.86L12.37 35.84L12.32 35.78Q13.16 35.27 14.18 34.83L14.18 34.83L13.52 36.85L13.57 36.90Q16.42 35.78 18.19 35.61L18.17 35.59L18.11 35.53Q18.64 30.72 18.81 27.19L18.75 27.13L18.91 27.28Q18.96 25.60 20.69 24.62L20.57 24.50L20.65 24.58Q21.01 24.25 21.48 24.29L21.64 24.44L21.49 24.29Q21.64 24.31 21.95 24.34L21.93 24.33L22.41 24.50L22.50 24.58Q22.34 24.76 22.44 25.17L22.61 25.34L22.61 25.34Q22.66 30.63 23.10 33.69Z"/><path d="M9 11 C62 35,52 22,94 12" stroke="#6fc8e5" fill="none"/><path fill="#484845" d="M59.84 24.08L59.89 24.13L59.88 24.12Q59.96 28.00 59.31 31.71L59.17 31.57L59.34 31.74Q61.26 31.15 64.01 31.04L64.03 31.06L64.03 31.05Q65.25 31.26 66.20 30.36L66.18 30.34L66.10 30.25Q67.12 29.43 67.12 28.24L67.19 28.31L67.09 28.21Q67.01 27.86 66.98 27.62L67.16 27.80L67.16 27.80Q66.87 25.02 64.86 24.28L64.88 24.29L64.96 24.37Q64.30 24.12 63.69 24.19L63.56 24.07L63.66 24.16Q62.64 24.03 61.73 24.06L61.75 24.09L61.75 24.09Q60.78 24.10 59.86 24.10ZM58.78 14.80L58.84 14.86L58.84 14.85Q59.67 17.86 59.91 21.77L59.86 21.72L59.93 21.80Q61.06 21.73 63.44 21.76L63.42 21.75L63.43 21.76Q66.07 21.81 66.37 18.65L66.34 18.62L66.44 18.72Q66.53 16.91 65.28 16.16L65.39 16.27L65.34 16.22Q64.62 15.84 60.68 15.27L60.68 15.27L60.58 15.17Q59.62 15.02 58.80 14.82ZM55.48 35.19L55.63 35.34L55.58 35.29Q57.69 29.24 57.45 22.64L57.62 22.81L57.53 22.72Q57.27 16.20 54.65 10.43L54.55 10.33L54.72 10.50Q58.09 12.75 63.65 12.97L63.54 12.86L63.63 12.95Q69.08 13.06 69.38 15.64L69.55 15.81L69.38 15.64Q69.68 18.12 68.42 20.50L68.47 20.54L68.57 20.65Q67.73 21.81 66.30 22.42L66.37 22.49L66.45 22.56Q69.66 23.12 69.86 27.92L69.91 27.96L69.82 27.88Q69.97 28.94 69.90 30.20L69.88 30.18L69.80 30.10Q69.78 31.31 68.95 32.14L68.95 32.14L69.03 32.21Q68.08 32.93 66.89 33.07L67.00 33.18L66.88 33.06Q65.76 33.33 64.81 33.33L64.64 33.17L64.80 33.32Q59.67 33.30 55.63 35.34ZM66.96 35.52L67.00 35.56L67.00 35.56Q67.83 35.61 69.50 35.71L69.48 35.70L69.41 35.62Q70.72 35.71 71.70 34.93L71.81 35.03L71.74 34.96Q72.48 34.17 72.38 32.78L72.41 32.81L72.32 32.72Q72.27 31.89 71.63 28.80L71.69 28.86L71.70 28.87Q71.04 25.94 69.38 24.61L69.32 24.55L69.04 23.90L69.02 23.88Q70.43 22.54 70.94 19.18L70.98 19.21L71.04 19.27Q71.16 18.23 71.09 16.97L71.00 16.89L71.11 17.00Q71.05 15.81 70.06 15.06L70.07 15.08L70.03 15.03Q69.82 14.93 69.72 14.89L69.72 14.89L69.56 14.74Q69.41 14.34 68.66 13.63L68.77 13.74L68.63 13.60Q67.22 12.59 63.44 12.42L63.47 12.45L63.58 12.56Q57.67 12.32 54.10 9.74L54.03 9.67L54.06 9.70Q56.97 15.94 57.24 22.67L57.17 22.61L57.24 22.67Q57.51 29.64 54.99 35.82L54.97 35.80L56.96 35.11L56.82 34.96Q56.48 35.98 56.04 37.00L56.18 37.14L56.18 37.15Q59.96 35.41 64.44 35.41L64.51 35.48L64.34 35.31Q65.63 35.34 66.92 35.48ZM64.99 26.04L65.12 26.17L65.05 26.09Q65.71 26.04 66.52 26.45L66.56 26.49L66.60 26.53Q66.70 26.83 66.83 27.78L66.80 27.74L66.78 27.73Q66.93 28.93 66.10 29.86L66.05 29.82L66.03 29.80Q65.22 30.75 63.96 30.65L63.99 30.68L62.68 30.80L62.75 30.86Q62.05 30.88 61.40 30.98L61.45 31.03L61.38 30.96Q61.62 29.29 61.68 26.20L61.71 26.23L61.70 26.22Q62.22 26.09 63.34 26.05L63.38 26.10L63.39 26.10Q64.50 26.06 65.04 26.09ZM64.09 17.49L64.24 17.64L64.59 17.65L64.40 17.46Q64.64 17.49 64.81 17.53L64.93 17.64L65.18 17.56L65.48 17.69L66.04 17.78L65.97 17.71Q66.19 18.06 66.19 18.33L66.22 18.36L66.18 18.80L66.03 18.65Q66.08 19.81 65.29 20.65L65.26 20.62L65.31 20.66Q64.64 21.61 63.55 21.61L63.42 21.48L63.41 21.47Q62.58 21.56 62.58 21.56L62.53 21.51L62.49 21.47Q61.35 21.47 61.65 21.47L61.77 21.59L61.76 21.58Q61.58 20.08 61.31 17.36L61.32 17.37L61.36 17.41Q62.74 17.50 64.10 17.50Z"/><path fill="#4c4b4d" d="M35.08 39.69L35.15 39.75L35.20 39.80Q34.16 39.79 32.46 40.06L32.52 40.11L32.58 40.18Q33.62 38.12 34.54 36.97L34.59 37.02L34.69 37.12Q36.17 37.30 36.30 37.30L36.25 37.25L36.41 37.41Q36.65 37.44 37.12 37.34L37.05 37.27L37.05 37.27Q37.66 37.20 37.83 37.20L37.90 37.27L37.90 37.27Q40.19 37.04 40.12 35.10L40.09 35.07L40.14 35.12Q40.04 33.74 39.94 28.16L40.01 28.23L39.98 28.20Q39.96 25.05 40.02 21.34L39.97 21.29L41.31 21.20L41.31 21.21Q41.90 21.11 42.51 20.91L42.42 20.82L42.46 20.85Q42.13 24.67 42.16 28.58L42.29 28.71L42.20 28.62Q42.33 32.62 42.81 36.53L42.71 36.44L42.72 36.45Q42.91 36.84 42.91 37.08L42.91 37.08L42.77 36.94Q42.83 38.47 41.34 38.80L41.39 38.85L41.36 38.83Q38.48 39.07 35.04 39.65ZM41.17 18.10L39.28 15.33L39.30 15.35Q40.22 14.10 41.86 11.62L41.89 11.65L41.88 11.64Q42.40 12.37 43.59 14.00L43.64 14.05L41.25 18.19ZM43.87 41.88L43.89 41.90L43.91 41.92Q44.34 41.91 45.02 41.60L45.07 41.65L44.98 41.56Q45.26 40.92 45.26 40.52L45.40 40.66L45.25 40.50Q45.32 40.27 45.22 39.73L45.24 39.75L45.20 39.71Q44.08 34.06 44.08 26.99L43.98 26.90L43.98 26.90Q44.06 24.43 44.20 21.85L44.04 21.69L44.09 21.74Q43.66 21.95 42.64 22.23L42.67 22.26L42.71 22.30Q42.62 21.77 42.66 21.29L42.73 21.36L42.85 20.44L42.84 20.43Q41.16 20.84 39.56 20.88L39.57 20.89L39.67 20.99Q39.57 24.80 39.61 28.00L39.58 27.98L39.70 34.99L39.75 35.04Q39.85 36.84 37.92 36.95L37.85 36.88L37.79 36.82Q37.67 36.90 37.21 36.95L37.13 36.87L37.19 36.93Q36.82 37.07 36.58 37.07L36.57 37.06L36.49 36.98Q36.11 37.01 34.72 36.64L34.59 36.51L34.58 36.50Q34.18 37.05 33.19 38.54L33.35 38.70L31.87 40.65L31.91 40.70Q32.68 40.52 34.14 40.18L34.11 40.14L33.67 40.76L33.18 41.32L33.33 41.47Q35.25 41.21 36.44 41.28L36.49 41.33L36.46 41.30Q38.52 41.46 43.82 41.83ZM41.07 18.69L41.19 18.80L41.47 18.31L41.33 18.17Q41.70 18.60 42.55 20.03L42.70 20.18L42.59 20.07Q44.05 17.38 45.44 14.63L45.38 14.56L45.36 14.55Q44.41 13.05 43.56 11.89L43.54 11.88L43.62 11.95Q43.38 12.09 43.07 12.56L43.19 12.68L43.09 12.58Q42.84 12.13 41.96 10.97L41.85 10.86L41.90 10.92Q40.76 12.25 38.68 15.25L38.81 15.37L38.77 15.33Q39.64 16.48 41.17 18.79Z"/></svg>',
  })
  totpIMG: string;

  @ApiProperty({
    description: 'device Resresh Token',
    example: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJkZWl2Y2VCcmFuZCI6IkFwcGxlIiwiZGV2aWNlTW9kZWwiOiJpUGhvbmUiLCJkZXZpY2VOYW1lIjoiQXBwbGUgaVBob25lIFNhZmFyaSIsImRldmljZUlkIjoiMWRjYTMxNTktNDY1YS00OGRlLWIyNDgtOTcwNmUxNzY2MDAxIiwic3lzdGVtTmFtZSI6IlNhZmFyaSIsInN5c3RlbVZlcnNpb24iOiIxNi42IiwiaWF0IjoxNzQ1ODA1MDEwfQ.x2JGeaVAGmqsYIDiTQVRcnF_FFqYrafjIG_AM8kFngY',
  })
  deviceRefreshToken: string;
}
